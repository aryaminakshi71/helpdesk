import {
  BetterAuthError
} from "./chunk-CN2NBKNI.js";

// ../../node_modules/.bun/better-auth@1.4.14+d8d708348641e738/node_modules/better-auth/dist/plugins/access/access.mjs
function role(statements) {
  return {
    authorize(request, connector = "AND") {
      let success = false;
      for (const [requestedResource, requestedActions] of Object.entries(request)) {
        const allowedActions = statements[requestedResource];
        if (!allowedActions) return {
          success: false,
          error: `You are not allowed to access resource: ${requestedResource}`
        };
        if (Array.isArray(requestedActions)) success = requestedActions.every((requestedAction) => allowedActions.includes(requestedAction));
        else if (typeof requestedActions === "object") {
          const actions = requestedActions;
          if (actions.connector === "OR") success = actions.actions.some((requestedAction) => allowedActions.includes(requestedAction));
          else success = actions.actions.every((requestedAction) => allowedActions.includes(requestedAction));
        } else throw new BetterAuthError("Invalid access control request");
        if (success && connector === "OR") return { success };
        if (!success && connector === "AND") return {
          success: false,
          error: `unauthorized to access resource "${requestedResource}"`
        };
      }
      if (success) return { success };
      return {
        success: false,
        error: "Not authorized"
      };
    },
    statements
  };
}
function createAccessControl(s) {
  return {
    newRole(statements) {
      return role(statements);
    },
    statements: s
  };
}

// ../../node_modules/.bun/better-auth@1.4.14+d8d708348641e738/node_modules/better-auth/dist/plugins/two-factor/client.mjs
var twoFactorClient = (options) => {
  return {
    id: "two-factor",
    $InferServerPlugin: {},
    atomListeners: [{
      matcher: (path) => path.startsWith("/two-factor/"),
      signal: "$sessionSignal"
    }],
    pathMethods: {
      "/two-factor/disable": "POST",
      "/two-factor/enable": "POST",
      "/two-factor/send-otp": "POST",
      "/two-factor/generate-backup-codes": "POST",
      "/two-factor/get-totp-uri": "POST",
      "/two-factor/verify-totp": "POST",
      "/two-factor/verify-otp": "POST",
      "/two-factor/verify-backup-code": "POST"
    },
    fetchPlugins: [{
      id: "two-factor",
      name: "two-factor",
      hooks: { async onSuccess(context) {
        if (context.data?.twoFactorRedirect) {
          if (options?.onTwoFactorRedirect) await options.onTwoFactorRedirect();
        }
      } }
    }]
  };
};

// ../../node_modules/.bun/better-auth@1.4.14+d8d708348641e738/node_modules/better-auth/dist/plugins/admin/access/statement.mjs
var defaultStatements = {
  user: [
    "create",
    "list",
    "set-role",
    "ban",
    "impersonate",
    "delete",
    "set-password",
    "get",
    "update"
  ],
  session: [
    "list",
    "revoke",
    "delete"
  ]
};
var defaultAc = createAccessControl(defaultStatements);
var adminAc = defaultAc.newRole({
  user: [
    "create",
    "list",
    "set-role",
    "ban",
    "impersonate",
    "delete",
    "set-password",
    "get",
    "update"
  ],
  session: [
    "list",
    "revoke",
    "delete"
  ]
});
var userAc = defaultAc.newRole({
  user: [],
  session: []
});
var defaultRoles = {
  admin: adminAc,
  user: userAc
};

// ../../node_modules/.bun/better-auth@1.4.14+d8d708348641e738/node_modules/better-auth/dist/plugins/admin/has-permission.mjs
var hasPermission = (input) => {
  if (input.userId && input.options?.adminUserIds?.includes(input.userId)) return true;
  if (!input.permissions && !input.permission) return false;
  const roles = (input.role || input.options?.defaultRole || "user").split(",");
  const acRoles = input.options?.roles || defaultRoles;
  for (const role2 of roles) if (acRoles[role2]?.authorize(input.permission ?? input.permissions)?.success) return true;
  return false;
};

// ../../node_modules/.bun/better-auth@1.4.14+d8d708348641e738/node_modules/better-auth/dist/plugins/organization/access/statement.mjs
var defaultStatements2 = {
  organization: ["update", "delete"],
  member: [
    "create",
    "update",
    "delete"
  ],
  invitation: ["create", "cancel"],
  team: [
    "create",
    "update",
    "delete"
  ],
  ac: [
    "create",
    "read",
    "update",
    "delete"
  ]
};
var defaultAc2 = createAccessControl(defaultStatements2);
var adminAc2 = defaultAc2.newRole({
  organization: ["update"],
  invitation: ["create", "cancel"],
  member: [
    "create",
    "update",
    "delete"
  ],
  team: [
    "create",
    "update",
    "delete"
  ],
  ac: [
    "create",
    "read",
    "update",
    "delete"
  ]
});
var ownerAc = defaultAc2.newRole({
  organization: ["update", "delete"],
  member: [
    "create",
    "update",
    "delete"
  ],
  invitation: ["create", "cancel"],
  team: [
    "create",
    "update",
    "delete"
  ],
  ac: [
    "create",
    "read",
    "update",
    "delete"
  ]
});
var memberAc = defaultAc2.newRole({
  organization: [],
  member: [],
  invitation: [],
  team: [],
  ac: ["read"]
});
var defaultRoles2 = {
  admin: adminAc2,
  owner: ownerAc,
  member: memberAc
};

// ../../node_modules/.bun/better-auth@1.4.14+d8d708348641e738/node_modules/better-auth/dist/plugins/organization/permission.mjs
var hasPermissionFn = (input, acRoles) => {
  if (!input.permissions && !input.permission) return false;
  const roles = input.role.split(",");
  const creatorRole = input.options.creatorRole || "owner";
  const isCreator = roles.includes(creatorRole);
  const allowCreatorsAllPermissions = input.allowCreatorAllPermissions || false;
  if (isCreator && allowCreatorsAllPermissions) return true;
  for (const role2 of roles) if (acRoles[role2]?.authorize(input.permissions ?? input.permission)?.success) return true;
  return false;
};
var cacheAllRoles = /* @__PURE__ */ new Map();

export {
  role,
  createAccessControl,
  adminAc,
  userAc,
  defaultRoles,
  hasPermission,
  adminAc2,
  ownerAc,
  memberAc,
  defaultRoles2,
  hasPermissionFn,
  cacheAllRoles,
  twoFactorClient
};
//# sourceMappingURL=chunk-4FG35LXB.js.map
