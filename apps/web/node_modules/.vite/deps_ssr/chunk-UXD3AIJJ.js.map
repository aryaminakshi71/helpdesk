{
  "version": 3,
  "sources": ["../../../../../node_modules/.bun/better-auth@1.4.14+d8d708348641e738/node_modules/better-auth/src/client/parser.ts"],
  "sourcesContent": ["const PROTO_POLLUTION_PATTERNS = {\n\tproto:\n\t\t/\"(?:_|\\\\u0{2}5[Ff]){2}(?:p|\\\\u0{2}70)(?:r|\\\\u0{2}72)(?:o|\\\\u0{2}6[Ff])(?:t|\\\\u0{2}74)(?:o|\\\\u0{2}6[Ff])(?:_|\\\\u0{2}5[Ff]){2}\"\\s*:/,\n\tconstructor:\n\t\t/\"(?:c|\\\\u0063)(?:o|\\\\u006[Ff])(?:n|\\\\u006[Ee])(?:s|\\\\u0073)(?:t|\\\\u0074)(?:r|\\\\u0072)(?:u|\\\\u0075)(?:c|\\\\u0063)(?:t|\\\\u0074)(?:o|\\\\u006[Ff])(?:r|\\\\u0072)\"\\s*:/,\n\tprotoShort: /\"__proto__\"\\s*:/,\n\tconstructorShort: /\"constructor\"\\s*:/,\n} as const;\n\nconst JSON_SIGNATURE =\n\t/^\\s*[\"[{]|^\\s*-?\\d{1,16}(\\.\\d{1,17})?([Ee][+-]?\\d+)?\\s*$/;\n\nconst SPECIAL_VALUES = {\n\ttrue: true,\n\tfalse: false,\n\tnull: null,\n\tundefined: undefined,\n\tnan: Number.NaN,\n\tinfinity: Number.POSITIVE_INFINITY,\n\t\"-infinity\": Number.NEGATIVE_INFINITY,\n} as const;\n\nconst ISO_DATE_REGEX =\n\t/^(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})(?:\\.(\\d{1,7}))?(?:Z|([+-])(\\d{2}):(\\d{2}))$/;\n\ntype ParseOptions = {\n\t/** Throw errors instead of returning the original value */\n\tstrict?: boolean | undefined;\n\t/** Log warnings when suspicious patterns are detected */\n\twarnings?: boolean | undefined;\n\t/** Custom reviver function */\n\treviver?: ((key: string, value: any) => any) | undefined;\n\t/** Automatically convert ISO date strings to Date objects */\n\tparseDates?: boolean | undefined;\n};\n\nfunction isValidDate(date: Date): boolean {\n\treturn date instanceof Date && !isNaN(date.getTime());\n}\n\nfunction parseISODate(value: string): Date | null {\n\tconst match = ISO_DATE_REGEX.exec(value);\n\tif (!match) return null;\n\n\tconst [\n\t\t,\n\t\tyear,\n\t\tmonth,\n\t\tday,\n\t\thour,\n\t\tminute,\n\t\tsecond,\n\t\tms,\n\t\toffsetSign,\n\t\toffsetHour,\n\t\toffsetMinute,\n\t] = match;\n\n\tconst date = new Date(\n\t\tDate.UTC(\n\t\t\tparseInt(year!, 10),\n\t\t\tparseInt(month!, 10) - 1,\n\t\t\tparseInt(day!, 10),\n\t\t\tparseInt(hour!, 10),\n\t\t\tparseInt(minute!, 10),\n\t\t\tparseInt(second!, 10),\n\t\t\tms ? parseInt(ms.padEnd(3, \"0\"), 10) : 0,\n\t\t),\n\t);\n\n\tif (offsetSign) {\n\t\tconst offset =\n\t\t\t(parseInt(offsetHour!, 10) * 60 + parseInt(offsetMinute!, 10)) *\n\t\t\t(offsetSign === \"+\" ? -1 : 1);\n\t\tdate.setUTCMinutes(date.getUTCMinutes() + offset);\n\t}\n\n\treturn isValidDate(date) ? date : null;\n}\n\nfunction betterJSONParse<T = unknown>(\n\tvalue: unknown,\n\toptions: ParseOptions = {},\n): T {\n\tconst {\n\t\tstrict = false,\n\t\twarnings = false,\n\t\treviver,\n\t\tparseDates = true,\n\t} = options;\n\n\tif (typeof value !== \"string\") {\n\t\treturn value as T;\n\t}\n\n\tconst trimmed = value.trim();\n\n\tif (\n\t\ttrimmed.length > 0 &&\n\t\ttrimmed[0] === '\"' &&\n\t\ttrimmed.endsWith('\"') &&\n\t\t!trimmed.slice(1, -1).includes('\"')\n\t) {\n\t\treturn trimmed.slice(1, -1) as T;\n\t}\n\n\tconst lowerValue = trimmed.toLowerCase();\n\tif (lowerValue.length <= 9 && lowerValue in SPECIAL_VALUES) {\n\t\treturn SPECIAL_VALUES[lowerValue as keyof typeof SPECIAL_VALUES] as T;\n\t}\n\n\tif (!JSON_SIGNATURE.test(trimmed)) {\n\t\tif (strict) {\n\t\t\tthrow new SyntaxError(\"[better-json] Invalid JSON\");\n\t\t}\n\t\treturn value as T;\n\t}\n\n\tconst hasProtoPattern = Object.entries(PROTO_POLLUTION_PATTERNS).some(\n\t\t([key, pattern]) => {\n\t\t\tconst matches = pattern.test(trimmed);\n\t\t\tif (matches && warnings) {\n\t\t\t\tconsole.warn(\n\t\t\t\t\t`[better-json] Detected potential prototype pollution attempt using ${key} pattern`,\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn matches;\n\t\t},\n\t);\n\n\tif (hasProtoPattern && strict) {\n\t\tthrow new Error(\n\t\t\t\"[better-json] Potential prototype pollution attempt detected\",\n\t\t);\n\t}\n\n\ttry {\n\t\tconst secureReviver = (key: string, value: any) => {\n\t\t\tif (\n\t\t\t\tkey === \"__proto__\" ||\n\t\t\t\t(key === \"constructor\" &&\n\t\t\t\t\tvalue &&\n\t\t\t\t\ttypeof value === \"object\" &&\n\t\t\t\t\t\"prototype\" in value)\n\t\t\t) {\n\t\t\t\tif (warnings) {\n\t\t\t\t\tconsole.warn(\n\t\t\t\t\t\t`[better-json] Dropping \"${key}\" key to prevent prototype pollution`,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tif (parseDates && typeof value === \"string\") {\n\t\t\t\tconst date = parseISODate(value);\n\t\t\t\tif (date) {\n\t\t\t\t\treturn date;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn reviver ? reviver(key, value) : value;\n\t\t};\n\n\t\treturn JSON.parse(trimmed, secureReviver);\n\t} catch (error) {\n\t\tif (strict) {\n\t\t\tthrow error;\n\t\t}\n\t\treturn value as T;\n\t}\n}\n\nexport function parseJSON<T = unknown>(\n\tvalue: unknown,\n\toptions: ParseOptions = { strict: true },\n): T {\n\treturn betterJSONParse<T>(value, options);\n}\n"],
  "mappings": ";AAAA,IAAM,2BAA2B;EAChC,OACC;EACD,aACC;EACD,YAAY;EACZ,kBAAkB;;AAGnB,IAAM,iBACL;AAED,IAAM,iBAAiB;EACtB,MAAM;EACN,OAAO;EACP,MAAM;EACN,WAAW;EACX,KAAK;EACL,UAAU,OAAO;EACjB,aAAa,OAAO;;AAGrB,IAAM,iBACL;AAaD,SAAS,YAAY,MAAqB;AACzC,SAAO,gBAAgB,QAAQ,CAAC,MAAM,KAAK,QAAA,CAAS;;AAGrD,SAAS,aAAa,OAA4B;AACjD,QAAM,QAAQ,eAAe,KAAK,KAAA;AAClC,MAAI,CAAC,MAAO,QAAO;AAEnB,QAAM,CAAA,EAEL,MACA,OACA,KACA,MACA,QACA,QACA,IACA,YACA,YACA,YAAA,IACG;AAEJ,QAAM,OAAO,IAAI,KAChB,KAAK,IACJ,SAAS,MAAO,EAAA,GAChB,SAAS,OAAQ,EAAA,IAAM,GACvB,SAAS,KAAM,EAAA,GACf,SAAS,MAAO,EAAA,GAChB,SAAS,QAAS,EAAA,GAClB,SAAS,QAAS,EAAA,GAClB,KAAK,SAAS,GAAG,OAAO,GAAG,GAAA,GAAM,EAAA,IAAM,CAAA,CACvC;AAGF,MAAI,YAAY;AACf,UAAM,UACJ,SAAS,YAAa,EAAA,IAAM,KAAK,SAAS,cAAe,EAAA,MACzD,eAAe,MAAM,KAAK;AAC5B,SAAK,cAAc,KAAK,cAAA,IAAkB,MAAA;;AAG3C,SAAO,YAAY,IAAA,IAAQ,OAAO;;AAGnC,SAAS,gBACR,OACA,UAAwB,CAAA,GACpB;AACJ,QAAM,EACL,SAAS,OACT,WAAW,OACX,SACA,aAAa,KAAA,IACV;AAEJ,MAAI,OAAO,UAAU,SACpB,QAAO;AAGR,QAAM,UAAU,MAAM,KAAA;AAEtB,MACC,QAAQ,SAAS,KACjB,QAAQ,CAAA,MAAO,OACf,QAAQ,SAAS,GAAA,KACjB,CAAC,QAAQ,MAAM,GAAG,EAAA,EAAI,SAAS,GAAA,EAE/B,QAAO,QAAQ,MAAM,GAAG,EAAA;AAGzB,QAAM,aAAa,QAAQ,YAAA;AAC3B,MAAI,WAAW,UAAU,KAAK,cAAc,eAC3C,QAAO,eAAe,UAAA;AAGvB,MAAI,CAAC,eAAe,KAAK,OAAA,GAAU;AAClC,QAAI,OACH,OAAM,IAAI,YAAY,4BAAA;AAEvB,WAAO;;AAeR,MAZwB,OAAO,QAAQ,wBAAA,EAA0B,KAAA,CAC/D,CAAC,KAAK,OAAA,MAAa;AACnB,UAAM,UAAU,QAAQ,KAAK,OAAA;AAC7B,QAAI,WAAW,SACd,SAAQ,KACP,sEAAsE,GAAA,UAAI;AAG5E,WAAO;QAIc,OACtB,OAAM,IAAI,MACT,8DAAA;AAIF,MAAI;AACH,UAAM,gBAAA,CAAiB,KAAa,YAAe;AAClD,UACC,QAAQ,eACP,QAAQ,iBACRA,WACA,OAAOA,YAAU,YACjB,eAAeA,SACf;AACD,YAAI,SACH,SAAQ,KACP,2BAA2B,GAAA,sCAAI;AAGjC;;AAGD,UAAI,cAAc,OAAOA,YAAU,UAAU;AAC5C,cAAM,OAAO,aAAaA,OAAAA;AAC1B,YAAI,KACH,QAAO;;AAIT,aAAO,UAAU,QAAQ,KAAKA,OAAAA,IAASA;;AAGxC,WAAO,KAAK,MAAM,SAAS,aAAA;WACnB,OAAO;AACf,QAAI,OACH,OAAM;AAEP,WAAO;;;AAIT,SAAgB,UACf,OACA,UAAwB,EAAE,QAAQ,KAAA,GAC9B;AACJ,SAAO,gBAAmB,OAAO,OAAA;;",
  "names": ["value"]
}
